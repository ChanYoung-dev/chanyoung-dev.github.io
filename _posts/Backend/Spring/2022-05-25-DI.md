---
permalink: /Backend/Spring/DI/
title: "DI(ì˜ì¡´ì„± ì£¼ì…) ìƒì„±ì ì£¼ì…ëŠ” ì™œ í•„ìš”í•œê°€"
toc: true
categories:
  - BackendğŸ›Spring
comments: true
sidebar:
  - title: "BackendğŸ›"
  - nav: "Backend-menu"
tags:
  - Spring
  - Java
sexy: 1
main: "Spring"
header:
  teaser: https://user-images.githubusercontent.com/46098949/172867648-46852443-159a-4248-9ae6-f7b2591976fc.png
  overlay_image: https://user-images.githubusercontent.com/46098949/172867648-46852443-159a-4248-9ae6-f7b2591976fc.png
  overlay_filter: 0.5
excerpt: ìƒì„±ì ì£¼ì…ê³¼ DIì˜ í•„ìš”ì„±ê³¼ ì™œ ì‚¬ìš©í•´ì•¼í•˜ëŠ”ì§€ ì•Œì•„ë³¸ë‹¤
---
<span style = "font-size:1.5em;  font-weight: 700;">DIëŠ” ì™œ í•„ìš”í•œ ê²ƒì¸ê°€</span><br>
ìƒìƒì ì£¼ì…ì´ë¼ëŠ” ë§ì€ Spirngì„ í•˜ë©´ì„œ ìˆ˜ì—†ì´ ë“¤ì–´ë³´ì•˜ë‹¤. ê·¸ë ‡ë‹¤ë©´ ìƒì„±ì ì£¼ì…ì€ ì™œ í•„ìš”í•œ ê²ƒì¼ê¹Œ?
{: .notice--primary}

# ë°°ê²½

![image](https://user-images.githubusercontent.com/46098949/172867648-46852443-159a-4248-9ae6-f7b2591976fc.png){: .align-center}

`MemberRepository`ì˜ ì¸í„°í˜ì´ìŠ¤ê°€ ìˆê³  ì´ê²ƒì˜ êµ¬í˜„ì²´ `MemoryMemberRepository`ê°€ ìˆë‹¤.

ê·¸ë¦¬ê³  `MemberRepository`ë¥¼ ì‚¬ìš©í•˜ëŠ” `MemberService`ê°€ ìˆë‹¤.

`MemberService`ì™€ `MemberRepository`ë¥¼ ì—°ê²°í•´ë³´ì

**MemberService**

```java
public class MemberService {
    private final MemberRepository memberRepository = new MemoryMemberRepository();

    ...
}
```

ìœ„ì™€ ê°™ì´ Injectionì„ í•˜ë©´ ë¬¸ì œëŠ”? ì™¸ë¶€ì—ì„œ ì£¼ì…í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ í• ìˆ˜ê°€ ì—†ë‹¤.
ì™¸ë¶€ì—ì„œ ì£¼ì…í•˜ì§€ì•Šê³  ì‚¬ìš©í• ì‹œ ë¬¸ì œì ì€ ë¬´ì—‡ì¼ê¹Œ

# ë¬¸ì œì 1 - DIì˜ í•„ìš”ì„±



## 1. ìœ ì§€ë³´ìˆ˜ì— ì¢‹ì§€ì•Šë‹¤
ë§Œì•½ `MemoryMemberRepository`ê¸°ë°˜ìœ¼ë¡œ ì €ì¥ì†Œë¥¼ ê´€ë¦¬í•˜ë‹¤ê°€ <abbr title="" id="AmazonWebService">AWS</abbr> ê¸°ë°˜ìœ¼ë¡œ ë°”ê¾¸ë©´ `AWSMemberRepository`ì™€ ì˜ì¡´ê´€ê³„ ìˆëŠ” í´ë¼ì´ì–¸íŠ¸ ê°ì²´(ex. `MemberService`)ì˜ ì½”ë“œë¥¼ ëª¨ë‘ ë°”ê¿”ì•¼í•˜ëŠ” ë¶ˆí¸í•¨ì´ ìˆë‹¤

```java
public class MemberService {
    //private final MemberRepository memberRepository = new MemoryMemberRepository();
    private final MemberRepository memberRepository = new AWSMemberRepository();

    ...
}
```

## 2. í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ì™€ ê°™ì´ ë‹¤ë¥¸ ì™¸ë¶€ í´ë˜ìŠ¤ì—ì„œ í´ë¼ì´ì–¸íŠ¸ê°ì²´ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°

`MemberService`ë¥¼ í…ŒìŠ¤íŠ¸ë¥¼ í•˜ê¸°ìœ„í•´ Testí´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ í…ŒìŠ¤íŠ¸í•´ë³¸ë‹¤ ê°€ì •í•˜ì

ì™¸ë¶€ : MemberServiceTest

```java
class MemberServiceTest{
	MemberService memberService = new MemberService();
	MemoryMemberRepository memoryRepository = new MemoryMemberRepository();

	@AfterEach
  public void afterEach(){
      memberRepository.clearStore(); //ì´ë¶€ë¶„ë•Œë¬¸ì— memoryRepositoryê°€ í•„ìš”
  }

	... 
	void íšŒì›ê°€ì…() {
	...
	...
  }
}
```

- `MemberService`ì—ì„œ ì£¼ì…ëœ `MemberRepository`ì™€ `MemberServiceTest`ì—ì„œ ì‚¬ìš©í•˜ëŠ” `MemberRepository`ê°€ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ê°€ 2ê°œë¼ëŠ” ë¬¸ì œê°€ ìƒê¸´ë‹¤
- ì¦‰, `new MemoryMemberRepository()` ê°€ ë‘ë²ˆ ì´ë£¨ì–´ì¡Œë‹¤ëŠ” ëœ»
- DBê°€ ë¡œì»¬ ë©”ëª¨ë¦¬ë¼ê³  ì¹˜ë©´ Repositoryì— ìˆëŠ” DBëŠ” ì„œë¡œ ë‹¤ë¥¸ ì €ì¥ê³µê°„ìœ¼ë¡œ ì„œë¡œ ë‹¤ë¥¸ ë‘ê°œì˜ DBê°€ ìƒê²¨ë²„ë¦°ë‹¤
    - `MemoryMemberRepository`ê°ì²´ê°€ 2ê°œ(ì´í•˜ A, B) ìƒì„±ë˜ì—ˆê³  `MemoryMemberRepository` ë‚´ store ë³€ìˆ˜ì— static í‚¤ì›Œë“œê°€ ì—†ë‹¤ëŠ” ê²ƒì„ ì „ì œ
    - `A`ì— `Member(id:1, name:foo)` ì—”í‹°í‹°ë¥¼ ì €ì¥
    - `B`ì— `Member(id:100, name:bar)` ì—”í‹°í‹°ë¥¼ ì €ì¥
    - ìœ„ì™€ ê°™ì€ ìƒí™©ì´ë¼ë©´ ì €ì¥ê³µê°„ì´ ë³„ë„ë¡œ ë¶„ë¦¬ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— `name`ì„ `foo`ë¡œ ê°€ì§€ëŠ” ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ë ¤ë©´ ë¬´ì¡°ê±´ `A`ì— ì ‘ê·¼í•´ì•¼ í•˜ëŠ” ìƒí™©ì´ ë°œìƒ
    - ë§Œì•½ `static` í‚¤ì›Œë“œë¡œ ìƒì„±ëœ `store` ë³€ìˆ˜ì˜€ë‹¤ë©´ A, Bê°ì²´ëŠ” `store` ë³€ìˆ˜ë¥¼ ê³µìœ í•˜ê¸° ë•Œë¬¸ì— A, B ì–´ë””ì„œë“ ì§€ `name`ì„ `foo`ë¡œ ê°€ì§€ëŠ” ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŒ

ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸°ìœ„í•´ ì™¸ë¶€ì—ì„œ ì£¼ì…í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë°”ê¾¸ì–´ì•¼í•œë‹¤

# í•´ê²°1 :ì™¸ë¶€ì—ì„œ ì£¼ì…

**MemberService**

```java
public class MemberService {
	
	//private final MemberRepository memberRepository = new MemoryMemberRepository();
  private final MemberRepository memberRepository;

  public MemberService(MemberRepository memberRepository) {
      this.memberRepository = memberRepository;
  }
}
```

**MemberServiceTest**

```java
class MemberServiceTest {

  MemberService memberService;
  MemoryMemberRepository memberRepository;

  @BeforeEach
  public void beforeEach(){
      memberRepository = new MemoryMemberRepository();
      memberService = new MemberService(memberRepository);
  }

}
```

ì´ëŸ°ì‹ìœ¼ë¡œ ì™¸ë¶€ì—ì„œ ë‘ê°œ(MemberRepository, MemberService)ë¥¼ ì—°ê²°ì‹œì¼œì£¼ì–´ ì‚¬ìš©í• ìˆ˜ ìˆë‹¤.

í•˜ì§€ë§Œ ì´ê²ƒë„ ë‹¤ë¥¸ ë¬¸ì œê°€ ìˆë‹¤.

# ë¬¸ì œì 2 - ì‹±ê¸€í†¤

Controller(=ì™¸ë¶€)ì— Serviceë¥¼ DIë¥¼ í•˜ë ¤í•œë‹¤. 

```java
@Controller
public class MemberController {

  private final MemberRepository memberRepository = new MemoryMemberRepository();
  private final MemberService memberService = new MemberService(memberRepository);

}
```

ì´ëŸ° ë°©ì‹ìœ¼ë¡œ DIë¥¼ í•´ë„ ë˜ì§€ë§Œ ì´ë ‡ê²Œ í•˜ë©´ OrderControllerë¼ë“ ê°€ ë‹¤ë¥¸ Controllerë“¤ì´ `MemberServiceë¥¼ ì‚¬ìš©í•˜ë©´ ì—¬ëŸ¬ê°œì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒê¸°ëŠ” ë¬¸ì œê°€ ìˆë‹¤. â†’ í•˜ë‚˜ë¥¼ ìƒì„±í•´ì„œ ê°™ì´ ê³µìš©ìœ¼ë¡œ ì“°ì â†’ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— <abbr title="" id="Bean">ë¹ˆ</abbr>ìœ¼ë¡œ ë“±ë¡í•˜ì

# í•´ê²°2: ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡

ìŠ¤í”„ë§ ë¹ˆì„ ë“±ë¡í•˜ëŠ” 2ê°€ì§€ ë°©ë²•

- [ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ê³¼ ìë™ ì˜ì¡´ê´€ê³„ ì„¤ì •](https://www.notion.so/Why-DI-870f2202b4f94cf2b022f9ca6cb72e08) â†’ @Component
- [ìë°” ì½”ë“œë¡œ ì§ì ‘ ìŠ¤í”„ë§ ë¹ˆ ë“±ë¡í•˜ê¸°](https://www.notion.so/Why-DI-870f2202b4f94cf2b022f9ca6cb72e08) â†’ SpringConfig(@Configuration)

![image](https://user-images.githubusercontent.com/46098949/172867827-77c9e6b2-ccf4-4503-83a1-17d0f9d8a071.png)

---

## A. ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ê³¼ ìë™ ì˜ì¡´ê´€ê³„ ì„¤ì •

**MemberController**

```java
@Controller
public class MemberController {
    private final MemberService memberService;

    @Autowired
    public MemberController(MemberService memberService) {
        this.memberService = memberService;
    }
}
```

**MemberService**

```java
@Service
public class MemberService {
	private final MemberRepository memberRepository;
    
  @Autowired
  public MemberService(MemberRepository memberRepository) {
      this.memberRepository = memberRepository;
  }
	...
}
```

MemberRepository

```java
@Repository
public class MemoryMemberRepository implements MemberRepository{

    private static Map<Long, Member> store = new HashMap<>();
    private static long sequence = 0L;
		...
}
```

- `@Controller`ì™€ `@Service`ëŠ” `@Component`ê°€ í¬í•¨ë˜ì–´ìˆë‹¤
- `@Component`ëŠ” ìŠ¤í”„ë§ì»¨í…Œì´ë„ˆì— ìŠ¤í”„ë§ë¹ˆìœ¼ë¡œ ë“±ë¡í•´ì¤€ë‹¤
- `@Autowired`ë¥¼ í†µí•´ ì„œë¡œ ì£¼ì…ëœë‹¤

`@Autowired`ëŠ” Beanìœ¼ë¡œ ë“±ë¡ëœ í´ë˜ìŠ¤ë§Œ ê°€ëŠ¥í•˜ë‹¤
{: .notice--warning}

## B. ìë°” ì½”ë“œë¡œ ì§ì ‘ ìŠ¤í”„ë§ ë¹ˆ ë“±ë¡í•˜ê¸°

---

**ë¹„êµë¥¼ ìœ„í•´ ê¸°ì¡´ Componet ë“±ë¡ ì‚­ì œí•˜ì**

**MemberService**

```java
//@Service
public class MemberService {
    //private final MemberRepository memberRepository = new MemoryMemberRepository();
    private final MemberRepository memberRepository;
c
    //@Autowired
    public MemberService(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }
```

**MemberRepository**

```java
//@Repository
public class MemoryMemberRepository implements MemberRepository{
	...
}
```

---

**ì§ì ‘ ë¹ˆ ë“±ë¡**

**SpringConfig**

```java
@Configuration
public class SpringConfig {
    @Bean
    public MemberService memberService() {
        return new MemberService(memberRepository());
    }
    @Bean
    public MemberRepository memberRepository() {
        return new MemoryMemberRepository();
    }
}
```

ë‘ê°€ì§€ ë°©ì‹ ì¤‘ ë¬´ì—‡ì„ ì„ íƒí•´ì•¼í• ê¹Œ

- ì‹¤ë¬´ì—ì„œëŠ” ì£¼ë¡œ ì •í˜•í™”ëœ ì»¨íŠ¸ë¡¤ëŸ¬, ì„œë¹„ìŠ¤, ë¦¬í¬ì§€í† ë¦¬ ê°™ì€ ì½”ë“œëŠ” ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì„ ì‚¬ìš©í•œë‹¤.
- ê·¸ë¦¬ê³  ì •í˜•í™” ë˜ì§€ ì•Šê±°ë‚˜, ìƒí™©ì— ë”°ë¼ êµ¬í˜„ í´ë˜ìŠ¤ë¥¼ ë³€ê²½í•´ì•¼ í•˜ë©´ ì„¤ì •ì„ í†µí•´ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ
ë“±ë¡
- ë‹¤í˜•ì„±ì„ ì´ìš©í•˜ëŠ” ê²½ìš° ì˜ˆë¥¼ë“¤ë©´ ìœ„ì—ì„œ ë§Œë“  `MemoryMemberRepository`ì™€ ê°™ì´ ì–¸ì œë“  ë°”ê¿€ìˆ˜ ìˆëŠ”ê²½ìš° ì„¤ì •ì„ í†µí•´ ìŠ¤í”„ë§ ë¹ˆ ë“±ë¡ì´ ì¢‹ë‹¤


ìŠ¤í”„ë§ ë¹ˆë“±ë¡ ë¶€ë¶„ì„ ë³´ë©´ `@Configuration`ê³¼ `@Bean`ê°€ ìˆë‹¤. ì´ ì• ë…¸í…Œì´ì…˜ì€ ë¬´ìŠ¨ ì—­í• ì„ í• ê¹Œ  
[ë‹¤ìŒ í¬ìŠ¤íŒ…](https://chanyoung-dev.github.io/Backend/Spring/IoC/)ì—ì„œ ì•Œì•„ë³´ì 

