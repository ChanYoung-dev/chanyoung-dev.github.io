---
permalink: /Backend/Spring/assert/
title: "Assertì„ ì»¤ìŠ¤í…€(custom)í•˜ì—¬ íŒŒë¼ë¯¸í„° ê²€ì¦"
toc: true
categories:
  - JavağŸ›Spring
comments: true
sidebar:
  - title: "JavağŸ›"
  - nav: "Backend-menu"
tags:
  - Spring
  - Java
sexy: 1
main: "Spring"
header:
  teaser: https://bulas.farmadelivery.com.br/wp-content/uploads/2022/02/bula-assert.jpg
  overlay_image: https://bulas.farmadelivery.com.br/wp-content/uploads/2022/02/bula-assert.jpg
  overlay_filter: 0.5
excerpt: \#ExceptionHandler  \#Exception  \#ControllerAdvice
---

<span style = "font-size:1.5em;  font-weight: 700;">Assertë¥¼ ì»¤ìŠ¤í…€<sup>custom</sup>í•´ë³´ì</span><br>
[ì»¤ìŠ¤í…€í•œ ì• ë…¸í…Œì´ì…˜ì„ í†µí•´ íŒŒë¼ë¯¸í„° ê²€ì¦í•˜ê¸°](https://chanyoung-dev.github.io/Backend/Spring/annotation/)ì„ í†µí•´ íŒŒë¼ë¯¸í„° ê²€ì¦í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì•˜ë‹¤. í•˜ì§€ë§Œ ì´ëŠ” `@RequestBody`ì´ë‚˜ `@ModelAttribute`ì—ë‚˜ ì ìš©ì´ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— Requestë¡œ ë“¤ì–´ì˜¤ëŠ” íŒŒë¼ë¯¸í„°ë§Œ ì•„ë‹Œ ì¼ë°˜ íŒŒë¼ë¯¸í„°ì— ëŒ€í•œ ê²ƒë„ íŒŒë¼ë¯¸í„° ê²€ì¦ì´ í•„ìš”í•  ë•Œê°€ ìˆë‹¤.  
ì´ ë•Œ AOPë¥¼ ì‚¬ìš©í•´ë„ ë˜ì§€ë§Œ ë„ˆë¬´ ì–´ë µë‹¤ëŠ” ë‹¨ì ì´ ìˆë‹¤. ê°„ë‹¨í•˜ê²Œ íŒŒë¼ë¯¸í„° ê²€ì¦ì„ í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ìˆë‹¤.  
ë°”ë¡œ `Assert`ì´ë‹¤
{: .notice--info}


# 1. ê¸°ë³¸ Assert
[Assert ìŠ¤í”„ë§ê³µì‹ë¬¸ì„œ](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/util/Assert.html)ë¥¼ í™•ì¸í•˜ê±°ë‚˜ ì§ì ‘ ì½”ë“œë¥¼ importí•´ì„œ í™•ì¸í•´ë³´ë©´ ê¸°ë³¸ì˜ Assert ì‚¬ìš©ë²•ì´ ì˜ ë‚˜ì™€ìˆë‹¤
{% highlight java linenos %}
public abstract class Assert {
  ...

  public static void isTrue(boolean expression, String message) {
      if (!expression) {
          throw new IllegalArgumentException(message);
      }
  }

  ...
}

Integer i = 0;
Assert.isTrue(i > 0, "The value must be greater than zero"); //ì‹¤ì œì‚¬ìš©ì½”ë“œ
{% endhighlight %}
- ìœ„ ì½”ë“œì—ì„œ 6ë²ˆì§¸ ë¼ì¸ì„ ë³´ë©´ `IllegalArgumentException`ì„ ë˜ì§€ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
- í•˜ì§€ë§Œ `IllegalArgumentException`ì´ ì•„ë‹ˆë¼ ìê¸°ê°€ ì›í•˜ëŠ” Exceptionì„ ë˜ì§€ê³  ì‹¶ì„ìˆ˜ ìˆë‹¤.

# 2. ê¸°ë³¸ Assert íŠœë‹
## 2.1 ì›í•˜ëŠ” Exception ë˜ì§€ê¸°
{% highlight java linenos %}
public class CustomAssert extends Assert {

  ...

  public static void notNull(@Nullable Object object, String message, final Class<? extends RuntimeException> exceptionClass) {
      if (object == null) {
          throw throwException(message, exceptionClass);
      }
  }

  ...
  private static RuntimeException throwException(String message, final Class<? extends RuntimeException> exceptionClass) {
      try {
          return exceptionClass.getDeclaredConstructor( String.class ).newInstance( message );
      } catch (Exception e) {
          e.printStackTrace();
          throw new AssertException("ì˜ˆì™¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. "+e.getMessage());
      }
  }
}

public class ValidateKeyException extends RuntimeException{
  public ValidateKeyException() {}
  
  public ValidateKeyException(String message) {
      super(message);
  }
  
  public ValidateKeyException(String message, Throwable cause) {
      super(message, cause);
  }
  
  public ValidateKeyException(Throwable cause) {
      super(cause);
  }
}
{% endhighlight %}

## 2.2 ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©
{% highlight java linenos %}
  @Transactional
  public boolean verifyEmail(String key) {

      //Redisë¥¼ ì´ìš©í•˜ì—¬ Keyê°’ì˜ Valueê°’ì„ í†µí•´ ì‚¬ìš©ì ë©”ì¼ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤
      RequestMail requestMail = redisService.getMailData(key,RequestMail.class);

      // ìœ íš¨í•œ Keyê°€ ì•„ë‹ê²½ìš° email = null
      CustomAssert.notNull(requestMail,"ìœ íš¨í•œ í‚¤ê°€ ì•„ë‹™ë‹ˆë‹¤", ValidateKeyException.class);

      ...
  }
{% endhighlight %}
- ì—¬ê¸°ì„œì˜ 8ë²ˆì§¸ì¤„ì˜ `ValidateKeyException`ëŠ” ì§ì ‘ ë§Œë“  Exceptionì´ë©° ì´ Exceptionì€ RuntimeExceptionì„ ìƒì†ë°›ì•„ì•¼ í•œë‹¤
- 12ë²ˆì§¸ì˜ `AssertException` ë˜í•œ ì§ì ‘ ë§Œë“  Exceptionì´ë‹¤
- `throwException()`ì€ `ValidateKeyException`ì„ ì¸ìŠ¤í„´ìŠ¤í™”ì‹œì¼œì¤€ë‹¤

# 3. ì‹¬í™”
- ì‚¬ìš©ìì˜ ID ì…ë ¥ê°’ì„ í™•ì¸í•˜ì—¬ íŒ¨í„´ì— ë§ëŠ” IDê°€ ë“¤ì–´ì˜¤ëŠ”ì§€ ê²€ì¦í•´ë³´ì
- íŒ¨í„´ì€ ë‹¤ìŒê³¼ ê°™ë‹¤
  - `[a-zA-Z0-9]{6,20}`
  - ì˜ì–´ë‚˜ ìˆ«ìë¡œë§Œ 6-20ê¸€ì

## 3.1 CustomAssert
{% highlight java linenos %}
public class CustomAssert extends Assert {

    private static final String NUM_ALPHA_PATTERN = "^[a-zA-Z0-9]{6,20}$";

    public static void isLoginPattern(String object, String message) {
        isMatched(object, NUM_ALPHA_PATTERN, message, PatternException.class);
    }

    public static void isMatched(String object, String pattern, String message, Class<PatternException> patternExceptionClass) {
        if(object == null || "".equalsIgnoreCase(object)) return;

        if(!object.matches(pattern)) {
            throw throwException(message, patternExceptionClass);
        }
    }

    private static RuntimeException throwException(String message, final Class<? extends RuntimeException> exceptionClass) {
        try {
            return exceptionClass.getDeclaredConstructor( String.class ).newInstance( message );
        } catch (Exception e) {
            e.printStackTrace();
            throw new AssertException("ì˜ˆì™¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. "+e.getMessage());
        }
    }
}

public class PatternException  extends AccountStatusException {

    public PatternException() {
        super("íŒ¨í„´ ì˜¤ë¥˜");
    }
    public PatternException(String message) {
        super(message);
    }
    public PatternException(String message, Throwable cause) {
        super(message, cause);
    }

}
{% endhighlight %}
- 27ë²ˆì§¸ ë¼ì¸ì˜ `PatternException`ì€ `AccountStatusException`ì„ ìƒì†í•œë‹¤
- ì—¬ê¸°ì„œëŠ” Spring Securityë¥¼ ì‚¬ìš©í•˜ê¸°ë•Œë¬¸ì— `AccountStatusException`ë¥¼ ìƒì†í–ˆì§€ë§Œ Spring Securityì„ ì‚¬ìš©í•˜ì§€ì•ŠëŠ” ì¼ë°˜ì ì¸ ê²½ìš°ì—ëŠ” `RuntimeException`ì„ ìƒì†ë°›ëŠ”ë‹¤
```java
public class PatternException  extends RuntimeException {
```
- íŒ¨í„´ì— ë§ì§€ì•ŠëŠ” ê°’ì´ ë“¤ì–´ì˜¬ ê²½ìš° 6ë²ˆì§¸ ë¼ì¸ì— ì˜í•´ `PatternException`ì´ ë˜ì ¸ì§„ë‹¤

## 3.2 ì‚¬ìš©
{% highlight java linenos %}
@Override
public UserDetails loadUserByUsername(String loginId) throws UsernameNotFoundException {

    //íŒŒë¼ë¯¸í„° ê²€ì¦
    CustomAssert.isLoginPattern(loginId, "ì•„ì´ë””ë‚˜ ë¹„ë°€ë²ˆí˜¸ íŒ¨í„´ì´ ë§ì§€ì•ŠìŠµë‹ˆë‹¤");

    LoginUserDto loginUserDto = this.findUserByLoginId(loginId);


    ...

    return member;
}
{% endhighlight %}


